2025-11-23 22:44:38,224 - INFO - [<module>:912] - [START] Quiz Solver Service v5
2025-11-23 22:44:38,224 - INFO - [<module>:913] - [START] AIPIPE configured: True
2025-11-23 22:44:38,224 - INFO - [<module>:914] - [START] SECRET configured: True
2025-11-23 22:44:38,225 - DEBUG - [__init__:64] - Using selector: KqueueSelector
2025-11-23 22:44:38,234 - INFO - [_serve:84] - Started server process [88008]
2025-11-23 22:44:38,234 - INFO - [startup:48] - Waiting for application startup.
2025-11-23 22:44:38,234 - INFO - [startup:62] - Application startup complete.
2025-11-23 22:44:38,235 - INFO - [_log_started_message:216] - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-11-23 22:44:41,418 - INFO - [receive_request:878] - [API] POST /receive_request
2025-11-23 22:44:41,418 - INFO - [receive_request:896] - [API] Valid request for 23f2000524@ds.study.iitm.ac.in
2025-11-23 22:44:41,418 - INFO - [send:473] - 127.0.0.1:51676 - "POST /receive_request HTTP/1.1" 200
2025-11-23 22:44:41,418 - INFO - [process_request:832] - 
======================================================================
2025-11-23 22:44:41,419 - INFO - [process_request:833] - [CHAIN] Starting for 23f2000524@ds.study.iitm.ac.in
2025-11-23 22:44:41,419 - INFO - [process_request:834] - [CHAIN] Initial URL: http://tds-llm-analysis.s-anand.net/demo
2025-11-23 22:44:41,419 - INFO - [process_request:835] - [CHAIN] Extended timeout: 300 seconds (5 minutes)
2025-11-23 22:44:41,419 - INFO - [process_request:836] - ======================================================================

2025-11-23 22:44:41,419 - INFO - [process_request:852] - [CHAIN] Quiz 1/10 | 0.0s elapsed | 300.0s remaining
2025-11-23 22:44:41,419 - INFO - [process_quiz:768] - [QUIZ] Starting: http://tds-llm-analysis.s-anand.net/demo
2025-11-23 22:44:41,419 - DEBUG - [extract_url_params:71] - [CONTEXT] Extracted variables: {'EMAIL': '23f2000524@ds.study.iitm.ac.in'}
2025-11-23 22:44:41,419 - DEBUG - [process_quiz:773] - [QUIZ] Step 1: Fetch page
2025-11-23 22:44:41,419 - INFO - [fetch_page:125] - [FETCH] Starting fetch: http://tds-llm-analysis.s-anand.net/demo
2025-11-23 22:44:41,419 - DEBUG - [fetch_page:130] - [FETCH] Attempting static fetch
2025-11-23 22:44:41,468 - DEBUG - [atrace:87] - connect_tcp.started host='tds-llm-analysis.s-anand.net' port=80 local_address=None timeout=30.0 socket_options=None
2025-11-23 22:44:41,561 - DEBUG - [atrace:87] - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x105bb27b0>
2025-11-23 22:44:41,561 - DEBUG - [atrace:87] - send_request_headers.started request=<Request [b'GET']>
2025-11-23 22:44:41,561 - DEBUG - [atrace:87] - send_request_headers.complete
2025-11-23 22:44:41,561 - DEBUG - [atrace:87] - send_request_body.started request=<Request [b'GET']>
2025-11-23 22:44:41,561 - DEBUG - [atrace:87] - send_request_body.complete
2025-11-23 22:44:41,561 - DEBUG - [atrace:87] - receive_response_headers.started request=<Request [b'GET']>
2025-11-23 22:44:41,592 - DEBUG - [atrace:87] - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sun, 23 Nov 2025 17:14:41 GMT'), (b'Content-Type', b'text/html'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'CF-Cache-Status', b'HIT'), (b'Cache-Control', b'public, max-age=0, must-revalidate'), (b'Nel', b'{"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}'), (b'Vary', b'accept-encoding'), (b'Report-To', b'{"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=CEMeOYObIrXs4oCtPtCbPFpQC3UakflOjh0BNGlWRFee48bhZQi1%2F%2FiaE43sQ6O1%2FXe0JEXfdw0%2BEfBd1WkAlbMWBXcdXUsN3O3hSK9cIYJOezYES5xgvyNrpYE%3D"}]}'), (b'ETag', b'W/"ce08b59240a57c2e963ec19952224928"'), (b'Content-Encoding', b'gzip'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9a324de9dd8ab6de-DEL'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-11-23 22:44:41,593 - DEBUG - [atrace:87] - receive_response_body.started request=<Request [b'GET']>
2025-11-23 22:44:41,593 - DEBUG - [atrace:87] - receive_response_body.complete
2025-11-23 22:44:41,593 - DEBUG - [atrace:87] - response_closed.started
2025-11-23 22:44:41,593 - DEBUG - [atrace:87] - response_closed.complete
2025-11-23 22:44:41,594 - DEBUG - [atrace:87] - close.started
2025-11-23 22:44:41,594 - DEBUG - [atrace:87] - close.complete
2025-11-23 22:44:41,594 - DEBUG - [fetch_page:135] - [FETCH] Static fetch successful: 336 bytes
2025-11-23 22:44:41,594 - DEBUG - [process_quiz:779] - [QUIZ] Step 2: Extract data
2025-11-23 22:44:41,594 - INFO - [extract_data:219] - [EXTRACT] Parsing page data
2025-11-23 22:44:41,595 - DEBUG - [extract_data:248] - [EXTRACT] Found 0 links
2025-11-23 22:44:41,595 - DEBUG - [extract_data:262] - [EXTRACT] Found 0 tables
2025-11-23 22:44:41,595 - DEBUG - [extract_data:282] - [EXTRACT] Found 0 forms
2025-11-23 22:44:41,595 - DEBUG - [extract_base64_content:182] - [EXTRACT] Searching for base64 encoded content
2025-11-23 22:44:41,595 - DEBUG - [extract_file_metadata:197] - [EXTRACT] Extracting file metadata
2025-11-23 22:44:41,595 - DEBUG - [extract_data:291] - [EXTRACT] Found 0 files
2025-11-23 22:44:41,595 - DEBUG - [process_quiz:782] - [QUIZ] Step 3: First LLM call - Understanding phase
2025-11-23 22:44:41,595 - INFO - [llm_understand:395] - [LLM_UNDERSTAND] Phase 1: Interpreting quiz page
2025-11-23 22:44:41,596 - DEBUG - [call_llm:308] - [LLM] Calling API with max_tokens=4000, timeout=120s
2025-11-23 22:44:41,596 - DEBUG - [call_llm:320] - [LLM] Attempt 1/5
2025-11-23 22:44:41,608 - DEBUG - [call_llm:323] - [LLM] Sending request to https://aipipe.org/openrouter/v1/chat/completions
2025-11-23 22:44:41,608 - DEBUG - [atrace:87] - connect_tcp.started host='aipipe.org' port=443 local_address=None timeout=120.0 socket_options=None
2025-11-23 22:44:41,702 - DEBUG - [atrace:87] - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x105bdf110>
2025-11-23 22:44:41,702 - DEBUG - [atrace:87] - start_tls.started ssl_context=<ssl.SSLContext object at 0x1059b7c70> server_hostname='aipipe.org' timeout=120.0
2025-11-23 22:44:41,720 - DEBUG - [atrace:87] - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x105bdf250>
2025-11-23 22:44:41,720 - DEBUG - [atrace:87] - send_request_headers.started request=<Request [b'POST']>
2025-11-23 22:44:41,721 - DEBUG - [atrace:87] - send_request_headers.complete
2025-11-23 22:44:41,721 - DEBUG - [atrace:87] - send_request_body.started request=<Request [b'POST']>
2025-11-23 22:44:41,721 - DEBUG - [atrace:87] - send_request_body.complete
2025-11-23 22:44:41,721 - DEBUG - [atrace:87] - receive_response_headers.started request=<Request [b'POST']>
2025-11-23 22:44:42,435 - DEBUG - [atrace:87] - receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Sun, 23 Nov 2025 17:14:42 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'59'), (b'Connection', b'keep-alive'), (b'Access-Control-Allow-Origin', b'*'), (b'access-control-allow-headers', b'Authorization, Content-Type'), (b'access-control-allow-methods', b'GET, POST'), (b'access-control-expose-headers', b'*'), (b'Vary', b'accept-encoding'), (b'Report-To', b'{"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=LxmbSUOtqBNRyHjMmCj60exYRVs1grnPbEvyRs5tFZnermHtMh57SgyMWO%2F05rShEbKeG52ckrRVlcZWbxd3y8eNVlC%2FJX6c7vM%3D"}]}'), (b'Nel', b'{"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9a324deadcd6d854-DEL'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-11-23 22:44:42,436 - DEBUG - [atrace:87] - receive_response_body.started request=<Request [b'POST']>
2025-11-23 22:44:42,436 - DEBUG - [atrace:87] - receive_response_body.complete
2025-11-23 22:44:42,436 - DEBUG - [atrace:87] - response_closed.started
2025-11-23 22:44:42,437 - DEBUG - [atrace:87] - response_closed.complete
2025-11-23 22:44:42,437 - DEBUG - [atrace:87] - close.started
2025-11-23 22:44:42,437 - DEBUG - [atrace:87] - close.complete
2025-11-23 22:44:42,437 - WARNING - [call_llm:342] - [LLM] Rate limited (429). Retry 1/5 after 2s backoff
2025-11-23 22:44:44,438 - DEBUG - [call_llm:320] - [LLM] Attempt 2/5
2025-11-23 22:44:44,458 - DEBUG - [call_llm:323] - [LLM] Sending request to https://aipipe.org/openrouter/v1/chat/completions
2025-11-23 22:44:44,459 - DEBUG - [atrace:87] - connect_tcp.started host='aipipe.org' port=443 local_address=None timeout=120.0 socket_options=None
2025-11-23 22:44:44,480 - DEBUG - [atrace:87] - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x105b8e060>
2025-11-23 22:44:44,480 - DEBUG - [atrace:87] - start_tls.started ssl_context=<ssl.SSLContext object at 0x1059b7e10> server_hostname='aipipe.org' timeout=120.0
2025-11-23 22:44:44,494 - DEBUG - [atrace:87] - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x105b8de00>
2025-11-23 22:44:44,494 - DEBUG - [atrace:87] - send_request_headers.started request=<Request [b'POST']>
2025-11-23 22:44:44,495 - DEBUG - [atrace:87] - send_request_headers.complete
2025-11-23 22:44:44,495 - DEBUG - [atrace:87] - send_request_body.started request=<Request [b'POST']>
2025-11-23 22:44:44,495 - DEBUG - [atrace:87] - send_request_body.complete
2025-11-23 22:44:44,495 - DEBUG - [atrace:87] - receive_response_headers.started request=<Request [b'POST']>
2025-11-23 22:44:44,659 - DEBUG - [atrace:87] - receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Sun, 23 Nov 2025 17:14:44 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'59'), (b'Connection', b'keep-alive'), (b'Access-Control-Allow-Origin', b'*'), (b'access-control-allow-headers', b'Authorization, Content-Type'), (b'access-control-allow-methods', b'GET, POST'), (b'access-control-expose-headers', b'*'), (b'Vary', b'accept-encoding'), (b'Report-To', b'{"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=sdPIbzKNR0C8mZM5fWQ3kdIueUC3L9LnCcG7pMoGX2IDe3GDHb%2FVwDg0wtzrSOC3vTR6A5RI98530M95Ai6HPfgupCdY%2BDLT0ao%3D"}]}'), (b'Nel', b'{"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9a324dfc29f21e0a-DEL'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-11-23 22:44:44,660 - DEBUG - [atrace:87] - receive_response_body.started request=<Request [b'POST']>
2025-11-23 22:44:44,661 - DEBUG - [atrace:87] - receive_response_body.complete
2025-11-23 22:44:44,661 - DEBUG - [atrace:87] - response_closed.started
2025-11-23 22:44:44,661 - DEBUG - [atrace:87] - response_closed.complete
2025-11-23 22:44:44,662 - DEBUG - [atrace:87] - close.started
2025-11-23 22:44:44,662 - DEBUG - [atrace:87] - close.complete
2025-11-23 22:44:44,662 - WARNING - [call_llm:342] - [LLM] Rate limited (429). Retry 2/5 after 4s backoff
2025-11-23 22:44:48,663 - DEBUG - [call_llm:320] - [LLM] Attempt 3/5
2025-11-23 22:44:48,683 - DEBUG - [call_llm:323] - [LLM] Sending request to https://aipipe.org/openrouter/v1/chat/completions
2025-11-23 22:44:48,684 - DEBUG - [atrace:87] - connect_tcp.started host='aipipe.org' port=443 local_address=None timeout=120.0 socket_options=None
2025-11-23 22:44:48,704 - DEBUG - [atrace:87] - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x105bf4ef0>
2025-11-23 22:44:48,704 - DEBUG - [atrace:87] - start_tls.started ssl_context=<ssl.SSLContext object at 0x102de9ae0> server_hostname='aipipe.org' timeout=120.0
2025-11-23 22:44:48,715 - DEBUG - [atrace:87] - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x105becf30>
2025-11-23 22:44:48,716 - DEBUG - [atrace:87] - send_request_headers.started request=<Request [b'POST']>
2025-11-23 22:44:48,716 - DEBUG - [atrace:87] - send_request_headers.complete
2025-11-23 22:44:48,716 - DEBUG - [atrace:87] - send_request_body.started request=<Request [b'POST']>
2025-11-23 22:44:48,716 - DEBUG - [atrace:87] - send_request_body.complete
2025-11-23 22:44:48,716 - DEBUG - [atrace:87] - receive_response_headers.started request=<Request [b'POST']>
2025-11-23 22:44:48,895 - DEBUG - [atrace:87] - receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Sun, 23 Nov 2025 17:14:48 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'59'), (b'Connection', b'keep-alive'), (b'Access-Control-Allow-Origin', b'*'), (b'access-control-allow-headers', b'Authorization, Content-Type'), (b'access-control-allow-methods', b'GET, POST'), (b'access-control-expose-headers', b'*'), (b'Vary', b'accept-encoding'), (b'Report-To', b'{"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=S1ELn6BlMxcrt%2FjO9yEuvuvEwOEx0OaThxRT9Mwea5JxUDxLK7O2oysU9FrnG3U7MTcRcDj9fSyOyQp7Cg9vRdDUwbLKf0wIef8%3D"}]}'), (b'Nel', b'{"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9a324e1689dd4e7b-DEL'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-11-23 22:44:48,896 - DEBUG - [atrace:87] - receive_response_body.started request=<Request [b'POST']>
2025-11-23 22:44:48,897 - DEBUG - [atrace:87] - receive_response_body.complete
2025-11-23 22:44:48,897 - DEBUG - [atrace:87] - response_closed.started
2025-11-23 22:44:48,897 - DEBUG - [atrace:87] - response_closed.complete
2025-11-23 22:44:48,898 - DEBUG - [atrace:87] - close.started
2025-11-23 22:44:48,898 - DEBUG - [atrace:87] - close.complete
2025-11-23 22:44:48,898 - WARNING - [call_llm:342] - [LLM] Rate limited (429). Retry 3/5 after 8s backoff
2025-11-23 22:44:56,899 - DEBUG - [call_llm:320] - [LLM] Attempt 4/5
2025-11-23 22:44:56,921 - DEBUG - [call_llm:323] - [LLM] Sending request to https://aipipe.org/openrouter/v1/chat/completions
2025-11-23 22:44:56,922 - DEBUG - [atrace:87] - connect_tcp.started host='aipipe.org' port=443 local_address=None timeout=120.0 socket_options=None
2025-11-23 22:44:56,943 - DEBUG - [atrace:87] - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x105bed370>
2025-11-23 22:44:56,943 - DEBUG - [atrace:87] - start_tls.started ssl_context=<ssl.SSLContext object at 0x105c11310> server_hostname='aipipe.org' timeout=120.0
2025-11-23 22:44:56,954 - DEBUG - [atrace:87] - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x105c1cb50>
2025-11-23 22:44:56,955 - DEBUG - [atrace:87] - send_request_headers.started request=<Request [b'POST']>
2025-11-23 22:44:56,955 - DEBUG - [atrace:87] - send_request_headers.complete
2025-11-23 22:44:56,955 - DEBUG - [atrace:87] - send_request_body.started request=<Request [b'POST']>
2025-11-23 22:44:56,955 - DEBUG - [atrace:87] - send_request_body.complete
2025-11-23 22:44:56,955 - DEBUG - [atrace:87] - receive_response_headers.started request=<Request [b'POST']>
2025-11-23 22:44:57,133 - DEBUG - [atrace:87] - receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Sun, 23 Nov 2025 17:14:57 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'59'), (b'Connection', b'keep-alive'), (b'Access-Control-Allow-Origin', b'*'), (b'access-control-allow-headers', b'Authorization, Content-Type'), (b'access-control-allow-methods', b'GET, POST'), (b'access-control-expose-headers', b'*'), (b'Vary', b'accept-encoding'), (b'Report-To', b'{"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=2kPu8wrpirRd3uXj9FwS1JKdbUSHuOLDBupu7GLe78vDoo%2FSgVCJKiDalH6r2gxlbqKvxh6GGRNTdlipQLbXQGK3YaITRmSFrWo%3D"}]}'), (b'Nel', b'{"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9a324e4a0945b117-DEL'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-11-23 22:44:57,134 - DEBUG - [atrace:87] - receive_response_body.started request=<Request [b'POST']>
2025-11-23 22:44:57,134 - DEBUG - [atrace:87] - receive_response_body.complete
2025-11-23 22:44:57,135 - DEBUG - [atrace:87] - response_closed.started
2025-11-23 22:44:57,135 - DEBUG - [atrace:87] - response_closed.complete
2025-11-23 22:44:57,136 - DEBUG - [atrace:87] - close.started
2025-11-23 22:44:57,136 - DEBUG - [atrace:87] - close.complete
2025-11-23 22:44:57,137 - WARNING - [call_llm:342] - [LLM] Rate limited (429). Retry 4/5 after 16s backoff
2025-11-23 22:45:13,138 - DEBUG - [call_llm:320] - [LLM] Attempt 5/5
2025-11-23 22:45:13,159 - DEBUG - [call_llm:323] - [LLM] Sending request to https://aipipe.org/openrouter/v1/chat/completions
2025-11-23 22:45:13,160 - DEBUG - [atrace:87] - connect_tcp.started host='aipipe.org' port=443 local_address=None timeout=120.0 socket_options=None
2025-11-23 22:45:13,168 - DEBUG - [atrace:87] - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x105c1d050>
2025-11-23 22:45:13,168 - DEBUG - [atrace:87] - start_tls.started ssl_context=<ssl.SSLContext object at 0x1059cf950> server_hostname='aipipe.org' timeout=120.0
2025-11-23 22:45:13,181 - DEBUG - [atrace:87] - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x105cf5b80>
2025-11-23 22:45:13,181 - DEBUG - [atrace:87] - send_request_headers.started request=<Request [b'POST']>
2025-11-23 22:45:13,182 - DEBUG - [atrace:87] - send_request_headers.complete
2025-11-23 22:45:13,182 - DEBUG - [atrace:87] - send_request_body.started request=<Request [b'POST']>
2025-11-23 22:45:13,182 - DEBUG - [atrace:87] - send_request_body.complete
2025-11-23 22:45:13,182 - DEBUG - [atrace:87] - receive_response_headers.started request=<Request [b'POST']>
2025-11-23 22:45:13,346 - DEBUG - [atrace:87] - receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Sun, 23 Nov 2025 17:15:13 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'59'), (b'Connection', b'keep-alive'), (b'Access-Control-Allow-Origin', b'*'), (b'access-control-allow-headers', b'Authorization, Content-Type'), (b'access-control-allow-methods', b'GET, POST'), (b'access-control-expose-headers', b'*'), (b'Vary', b'accept-encoding'), (b'Report-To', b'{"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=Ue38Zh4hz4rCJwrN2rd%2B4JgHjdGx%2BYjF6Yl%2BTQbWnhkLa%2FLo5zxlmoim7VQLANFJxPerRWyGsg4g2jV%2FeWel9HKAh4cpOeaWb28%3D"}]}'), (b'Nel', b'{"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9a324eaf78be6ce7-DEL'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-11-23 22:45:13,347 - DEBUG - [atrace:87] - receive_response_body.started request=<Request [b'POST']>
2025-11-23 22:45:13,347 - DEBUG - [atrace:87] - receive_response_body.complete
2025-11-23 22:45:13,347 - DEBUG - [atrace:87] - response_closed.started
2025-11-23 22:45:13,347 - DEBUG - [atrace:87] - response_closed.complete
2025-11-23 22:45:13,348 - DEBUG - [atrace:87] - close.started
2025-11-23 22:45:13,348 - DEBUG - [atrace:87] - close.complete
2025-11-23 22:45:13,348 - WARNING - [call_llm:342] - [LLM] Rate limited (429). Retry 5/5 after 32s backoff
2025-11-23 22:45:25,704 - INFO - [shutdown:264] - Shutting down
2025-11-23 22:45:25,806 - INFO - [_wait_tasks_to_complete:306] - Waiting for background tasks to complete. (CTRL+C to force quit)
2025-11-23 22:45:30,055 - INFO - [_serve:94] - Finished server process [88008]
2025-11-23 22:45:30,065 - ERROR - [send:134] - Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/runners.py", line 204, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/runners.py", line 127, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/base_events.py", line 706, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/base_events.py", line 677, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/base_events.py", line 2046, in _run_once
    handle._run()
    ~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/uvicorn/server.py", line 70, in serve
    with self.capture_signals():
         ~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/uvicorn/server.py", line 331, in capture_signals
    signal.raise_signal(captured_signal)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/runners.py", line 166, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/starlette/routing.py", line 701, in lifespan
    await receive()
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-11-23 22:45:30,066 - ERROR - [run_asgi:408] - Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/runners.py", line 204, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/runners.py", line 127, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/base_events.py", line 706, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/base_events.py", line 677, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/base_events.py", line 2046, in _run_once
    handle._run()
    ~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/uvicorn/server.py", line 70, in serve
    with self.capture_signals():
         ~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/uvicorn/server.py", line 331, in capture_signals
    signal.raise_signal(captured_signal)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/runners.py", line 166, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/uvicorn/protocols/http/h11_impl.py", line 403, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/starlette/applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/fastapi/routing.py", line 125, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/fastapi/routing.py", line 112, in app
    await response(scope, receive, send)
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/starlette/responses.py", line 167, in __call__
    await self.background()
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/starlette/background.py", line 36, in __call__
    await task()
  File "/Users/goldenmehmood/.cache/uv/environments-v2/rec-req-52b8bfcfd2afe510/lib/python3.14/site-packages/starlette/background.py", line 21, in __call__
    await self.func(*self.args, **self.kwargs)
  File "/Users/goldenmehmood/Documents/iitmwork/tds/tdsproj2gitted/tdsproject2/rec_req.py", line 855, in process_request
    success, next_url = await process_quiz(current_url, email, secret, BASE_URL)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/goldenmehmood/Documents/iitmwork/tds/tdsproj2gitted/tdsproject2/rec_req.py", line 783, in process_quiz
    understanding = await llm_understand(data, context)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/goldenmehmood/Documents/iitmwork/tds/tdsproj2gitted/tdsproject2/rec_req.py", line 445, in llm_understand
    result = await call_llm(messages, max_tokens=4000, timeout=120)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/goldenmehmood/Documents/iitmwork/tds/tdsproj2gitted/tdsproject2/rec_req.py", line 343, in call_llm
    await asyncio.sleep(wait_time)
  File "/opt/homebrew/Cellar/python@3.14/3.14.0/Frameworks/Python.framework/Versions/3.14/lib/python3.14/asyncio/tasks.py", line 702, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError
